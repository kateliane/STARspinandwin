import { useState } from "react";
import { SpinWheel, WheelSlice } from "@/components/SpinWheel";
import { ResultModal } from "@/components/ResultModal";

const Index = () => {
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [winningPrize, setWinningPrize] = useState("");

  // Configure wheel slices with probability weights
  // Higher probability = more likely to win
  const wheelSlices: WheelSlice[] = [
    { 
      name: "Supreme Cream", 
      color: "--wheel-pink",
      probability: 10 // 10% chance
    },
    { 
      name: "Foundation", 
      color: "--wheel-purple",
      probability: 20 // 20% chance
    },
    { 
      name: "Night Serum", 
      color: "--wheel-blue",
      probability: 25 // 25% chance
    },
    { 
      name: "Lipstick Set", 
      color: "--wheel-cyan",
      probability: 15 // 15% chance
    },
    { 
      name: "Holiday Glow", 
      color: "--wheel-green",
      probability: 20 // 20% chance
    },
    { 
      name: "Futurist Moisturizer", 
      color: "--wheel-yellow",
      probability: 10 // 10% chance
    },
  ];

  const handleWin = (prize: string) => {
    setWinningPrize(prize);
    setIsModalOpen(true);
  };

  return (
    <div className="min-h-screen w-full flex flex-col items-center justify-center relative overflow-hidden">
      {/* Decorative Elements */}
      <div className="absolute inset-0 pointer-events-none opacity-10">
        <div className="absolute top-[10%] left-[10%] text-[150px] md:text-[150px] text-primary transform rotate-[15deg]">
          ✿
        </div>
        <div className="absolute bottom-[10%] right-[10%] text-[150px] md:text-[150px] text-primary transform -rotate-[15deg]">
          ✿
        </div>
      </div>

      {/* Header */}
      <header className="text-center mb-8 md:mb-12 px-4 absolute top-8 md:top-12 left-0 right-0 z-10">
        <h1 className="text-4xl md:text-6xl font-normal text-primary mb-4 tracking-[3px]">
          Spin2Win
        </h1>
        <p className="text-lg md:text-xl text-muted-foreground max-w-lg mx-auto font-light tracking-wide">
          Try your luck and win exclusive beauty products
        </p>
      </header>

      {/* Wheel Container */}
      <div className="flex-1 flex flex-col items-center justify-center w-full px-4 pt-32 md:pt-0">
        <SpinWheel slices={wheelSlices} onWin={handleWin} />
        
        {/* Desktop Instructions */}
        <p className="hidden md:block text-center mt-8 text-primary text-lg font-light tracking-wide">
          Gently drag the wheel to reveal your prize
        </p>
        
        {/* Mobile Instructions */}
        <p className="md:hidden text-center mt-8 text-primary text-xl font-normal animate-pulse-elegant tracking-wide">
          Drag to spin
        </p>
      </div>

      {/* Result Modal */}
      <ResultModal
        isOpen={isModalOpen}
        onClose={() => setIsModalOpen(false)}
        prize={winningPrize}
      />

      {/* Probability Info (Hidden - for developer reference) */}
      <div className="hidden">
        <h3>Wheel Probability Configuration:</h3>
        <ul>
          {wheelSlices.map((slice, index) => {
            const totalWeight = wheelSlices.reduce((sum, s) => sum + s.probability, 0);
            const percentage = ((slice.probability / totalWeight) * 100).toFixed(1);
            return (
              <li key={index}>
                {slice.name}: {slice.probability} weight ({percentage}% chance)
              </li>
            );
          })}
        </ul>
      </div>
    </div>
  );
};

export default Index;
